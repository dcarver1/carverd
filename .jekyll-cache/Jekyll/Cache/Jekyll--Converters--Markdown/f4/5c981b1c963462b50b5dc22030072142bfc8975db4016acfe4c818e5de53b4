I"Œ<p>Daniel Carver
2/13/2018</p>

<p><a href="https://github.com/dcarver1">github: dcarver1 </a></p>

<h1 id="outline">Outline</h1>
<p><strong>Goal provide some tips and tools to make arcpy a viable extension of arcmap</strong></p>

<h2 id="python">Python</h2>

<p>python is awesome. It is a full computer science language that has functionality in a wide range of fields I don‚Äôt really want to spend that much time with python generals here, but I‚Äôve included and awesome introduction to python that I use to learn the language.</p>

<p>You can find it here <a href="fill in link to the github page">link to python intro</a> I did not write this material, but is great.</p>

<p><strong>ArcMap uses python 2.7</strong></p>

<p><strong>ArcPro uses python 3.6</strong></p>

<h2 id="what-is-arcpy">What is arcpy</h2>

<p>Arcpy is essentially a python library that allows the user to access all the geoprocessing tools of arcpy via a python script. Arcpy does require an active license to Arcmap Arcpy is composed of modules, classes, and functions</p>

<ul>
  <li>Modules are essentially the extensions of arcpy. If you want to reference a tool form that requires a spatial analyst license you will be calling that function from the spatial analysis module.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="n">arcpy</span><span class="o">.</span><span class="n">CheckExtensions</span><span class="p">(</span><span class="s">"Spatial"</span><span class="p">)</span> <span class="c1">#checks out the licensed extension
</span></code></pre></div></div>

<ul>
  <li>classes provide the framework that specific functions are built from. They are not as readily used as functions.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="n">object1</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Extent</span><span class="p">(</span><span class="s">"path to layer"</span><span class="p">)</span><span class="c1"># this stores extent multiple properties to
# the object. ex(Xmin, Xmax, Ymin)
</span>
<span class="k">print</span> <span class="p">(</span> <span class="n">object1</span><span class="o">.</span><span class="n">Xmin</span><span class="p">)</span> <span class="c1"># you can then select specific extent properties from the
# objects
</span></code></pre></div></div>

<ul>
  <li>Function are the comparable to the tools that you use in the arcmap interface. You will often call functions to perform a certain task.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span> <span class="c1">#import library
</span><span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span> <span class="c1">#import the environment class
</span>
<span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s">r"C:/data"</span> <span class="c1">#calling the 'workspace' function from the env class
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">Clip_analysis</span><span class="p">(</span><span class="s">"majorrds.shp"</span><span class="p">,</span> <span class="s">"study_quads.shp"</span><span class="p">,</span> <span class="s">r"C:/output/studyarea.shp"</span><span class="p">)</span>
<span class="c1"># clipping a shp and saving the output with a defined name and location.
</span></code></pre></div></div>

<p>Functions has a sets of inputs that must be followed. Here is the example for cliping</p>

<p><a href="http://pro.arcgis.com/en/pro-app/tool-reference/analysis/clip.htm">clip tool</a> Clip_analysis (in_features, clip_features, out_feature_class, {cluster_tolerance}) in_features = feature layer clip_features = feature layer out_feature_class = feature class {cluster_tolerance} = optional</p>

<p><em>You need to look at the documentation to know what each input is required to be</em></p>

<h2 id="why-is-it-useful">why is it useful</h2>

<h3 id="promotes-high-level-understanding-of-geospatial-processing">promotes high level understanding of geospatial processing</h3>

<p>using arcpy will force you to look at the geoprocessing tools in greater detail. You will inevitably end up having a better understanding of the tools.</p>

<h3 id="increases-efficiency-and-reproducibility">increases efficiency and reproducibility</h3>

<p>Writing an arcpy script is essentially like writing a well documented outline. The method and the steps are inherent within the script. Also because it is ran via a computer it simply does what it is told this allows you to repeat the same task over and over without fear of forgetting to add one of those parameters.</p>

<h3 id="if-you-know-it-in-arcmap-you-can-make-it-happen-in-arcpy">If you know it in ArcMap you can make it happen in Arcpy</h3>

<p>If your familiar with working in arcmap you already know a lot about arcpy. I will be working on drawing the comparison between the two throughout this tutorial</p>

<h2 id="engaging-with-arcpy">Engaging with Arcpy</h2>

<p>Most people will end up using arcpy via the built in text editor within arcpy called IDLE. This is not the greatest text editor or development environment but it is really the easiest to use. Arcpy is installed with Arcmap as part of a stand alone distribution of python. So you try to use a separate development environment you need to show your computer where to look for all the modules, classes, and functions of arcpy. Therefore, if you don‚Äôt want to use IDLE, you need to do some work to set up your development environment before you can call ‚Äòimport arcpy‚Äô and successful gain access to the material you are looking for.</p>

<ol>
  <li>Use IDLE</li>
</ol>

<p>IDLE is a built in text editor that is included with any arcmap installation. It‚Äôs a no thrills development environment that works for python and python alone. When arcmap is installed it also installs a version of python. Everything you need to get coding in arcpy is wrapped up nicely for you. The only trouble is that the wrapping is a bit ugly and cumbersome. If your new to programming you wont be able to tell it‚Äôs ugly and cumbersome so rolling with it might be the way to go. Sooner or later your going to want out and the next easiest step is to move to using Anaconda.</p>

<ol>
  <li>Use Anaconda</li>
</ol>

<p>Anaconda is a python development system that provides a Integrated Development Environment (IDE) Spyder that allows you to code and troubleshoot all within the same program. What‚Äôs nice about anaconda is that it install a more robust set of packages and libraries for python, so you can use other libraries much easier. Remember that python is a whole computer language, we are just using a single rather small portion of it‚Äôs functionality. I liked using spyder because it opens up the bigger picture of python. By the time you find yourself switching from saying I use python to write in arcpy to I write in python and can use arcpy, your going to want something that gives a bit more then IDLE.</p>

<p>Here are instructions for making sure you can access the arcpy libraries within the spyder IDE Instructions for installing ArcGIS and anaconda</p>

<p>You can download Anaconda at <a href="https://www.continuum.io/downloads">https://www.continuum.io/downloads</a>. Follow the appropriate instructions below for your environment:</p>

<p>ArcGIS 10.X already installed:</p>

<ol>
  <li>
    <p>Install anaconda. You can proceed with all of the default installation options.</p>
  </li>
  <li>
    <p>Launch Spyder after the installation. Go to Tools -&gt; PYTHONPATH manager</p>
  </li>
</ol>

<p>Add the following paths: C:\Program Files (x86)\ArcGIS\Desktop10.2\arcpy C:\Program Files (x86)\ArcGIS\Desktop10.2\bin</p>

<ol>
  <li>restart the program</li>
</ol>

<p>If your arcGIS was installed in a different location you may have a different path. In this case just make sure your connected to the correct folder or this will not work.</p>

<ol>
  <li>Use Atom/CMD You can use a text editor such as arcpy but it will take a bit more set up If your interested check out this <a href="http://www.siliconcreek.net/computers/running-python-in-atom-io-in-windows">post</a> or you can add the python installation associated with the arc map installation of python to the environmental variables of your pc. This method will require administrative privileges on your pc. So if your on your own pc it should work if your working with a government computer this will most like not work <a href="https://docs.python.org/2/using/windows.html">https://docs.python.org/2/using/windows.html</a></li>
</ol>

<p>At the end of the day, it‚Äôs really the product that matters. I bring up these options because it is important to look ahead. But how you get there really is a matter of your own personal preference.</p>

<h2 id="what-is-arcpy-good-at">What is arcpy good at?</h2>

<p>The truth is that arcpy is really pretty awesome. It‚Äôs the functionality of arcmap with the flexibility of a programming language. I would say the greatest benefit of learning to use arcpy is that it helps you better understand what these geoprocessing tools are really doing. I‚Äôve listed a few features below that really stand out about arcpy.</p>

<h3 id="python-your-the-best">python, your the best</h3>

<p>We‚Äôre going to be viewing alot more code examples below and there is a super helpful built in function in python that you really ought to know. windows operating systems uses the backslash (‚Äò') symbol to distinguish between folders in paths, for example c:\users\documents\stuff</p>

<p>The trouble is that to most programming languages the backslash is an escape symbol. Specifics aside basically it is character that has a specific meaning that can not be overwritten. So python would read this path ‚Äòc:\users\documents\stuff‚Äô as ‚Äòc:‚Äô That‚Äôs no bueno.</p>

<p>Luckily there is a quick fix. Placing the letter ‚Äòr‚Äô in front of the path will tell python to treat the string as a raw string which takes the functionality away from the backslashes. so you path should look like this path = r‚Äôc:\users\documents\stuff‚Äô</p>

<p>beautiful Ok, now back to arcpy.</p>

<h3 id="environmental-variable">environmental variable</h3>

<p>On of the trademarks of good work is that it can be done consistently. Programming inherently bring in greater consistence because computers only do what you tell them to do. In geospatial work there are a lot of variables that you want to keep consistent across the analysis, such as projection, cell size, or extent. Arcpy makes that easy.</p>

<p>&lt;‚Äìput a picture here of the environmental variable button on a geoprocessing tool !‚Äì&gt;</p>

<p>Just like under the options of a geoprocessing tool you can set specific environmental variables by calling specific functions from the env class of arcpy. A full list of functions can be found at the link below and a few of the major ones will be highlighted below.</p>

<p><a href="http://pro.arcgis.com/en/pro-app/arcpy/classes/env.htm">env class</a></p>

<p>If you want to know a little more about this process here is a good resource</p>

<p><a href="http://pro.arcgis.com/en/pro-app/arcpy/geoprocessing_and_python/using-environment-settings.htm">using environmental variables in python</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="c1"># Set the workspace environment to local file geodatabase
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s">r"C:/data/base.gdb"</span>
<span class="c1"># I like to set this as a variable because it can help with name of features down the road
</span><span class="n">workspace</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s">r"C:/data/base.gdb"</span>

<span class="s">'''
this is how you comment out multiple lines of code below are notes on arcpy.env.workspace


this means that you can pull objects from that workspace by calling there names
bluePrint = 'bluePrint.shp'

Also any output files will be save to that location automatically.

If you ever want to work outside of the workspace
'''</span>

<span class="c1"># Set the workspace, outputCoordinateSystem
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">outputCoordinateSystem</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">(</span><span class="s">"WGS 1984 UTM Zone 18N"</span><span class="p">)</span>

<span class="c1"># the out put of this function will have the coordinate system of "WGS 1984 UTM Zone 18N"
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">Buffer_analysis</span><span class="p">(</span><span class="s">"roads.shp"</span><span class="p">,</span> <span class="s">"roads_buffer.shp"</span><span class="p">,</span> <span class="s">"10 meters"</span><span class="p">)</span>

<span class="c1"># Setting the extent of analysis
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">extent</span> <span class="o">=</span> <span class="s">r"C:/data/studyArea"</span>

<span class="c1"># Set Snap Raster environment
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">snapRaster</span> <span class="o">=</span> <span class="s">"C:/data/my_snapraster"</span>
<span class="c1"># this will align all outputs to match the grid of the given raster.
</span>
<span class="c1">#With a function such as cell size you can define the parameter in multiple ways
# Set the cell size environment using a keyword.
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cellSize</span> <span class="o">=</span> <span class="s">"MINOF"</span>
<span class="c1">#this will set the cell size to that of the minimum cell size raster in the analysis
</span>
<span class="c1"># Set the cell size environment using a number.
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cellSize</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># Set the cell size environment using a raster dataset.
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cellSize</span> <span class="o">=</span> <span class="s">"C:/sapyexamples/data/myraster"</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">extents</span><span class="p">(</span><span class="n">fc</span><span class="p">):</span>
    <span class="s">"""
    This function takes in an arcpy object and returns the spatial extent features
    """</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Describe</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span><span class="o">.</span><span class="n">extent</span>
    <span class="n">west</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">XMin</span>
    <span class="n">south</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">YMin</span>
    <span class="n">east</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">XMax</span>
    <span class="n">north</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">YMax</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">width</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">extent</span><span class="o">.</span><span class="n">height</span>
    <span class="k">return</span> <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">north</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span>
</code></pre></div></div>

<h3 id="iterating">iterating</h3>

<p>one of the biggest perks of programming is that you can make the computer do the boring stuff. Iterators are a perfect example of such a process. Lets say you have 15 rasters that you need to mask and re project to a different coordinate system.</p>

<p>You can run 30 geoprocessing tool in arc map or write a script</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#pull in the library
</span><span class="kn">import</span> <span class="nn">arcpy</span>
<span class="c1">#set the workspace
</span><span class="n">workspace</span> <span class="o">=</span> <span class="s">r'c:\rasters'</span>
<span class="c1">#set the environmental varible for a mask
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="s">r"C:/data/maskpoly.shp"</span>
<span class="c1">#enable overwrite so you can re write files with the same name
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">overwriteOutput</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1">#pull in a list of all the raster in a workspace
</span><span class="n">rasters</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ListRasters</span><span class="p">(</span><span class="n">workspace</span><span class="p">)</span>
<span class="c1"># view all the raster
</span><span class="k">print</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span>

<span class="c1">#write a for loop to iterate over the list
</span><span class="k">for</span> <span class="n">raster</span> <span class="ow">in</span> <span class="n">rasters</span><span class="p">:</span>
  <span class="n">arcpy</span><span class="o">.</span><span class="n">ProjectRaster_management</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">raster</span><span class="o">+</span><span class="s">'_pro'</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">'The raster'</span><span class="o">+</span><span class="n">raster</span> <span class="o">+</span><span class="s">' has been projected and masked.'</span><span class="p">)</span>
</code></pre></div></div>

<p>This save a lot of time!</p>

<p>Let‚Äôs break down the for loop a bit.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
  <span class="c1"># for each element in the list do something...
</span>  <span class="k">print</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
</code></pre></div></div>

<p>There are lots of options for loops and they can get complex. But it is really only when you start to implement loops that you find yourself appreciating the power of programming</p>

<h3 id="reproducibility">Reproducibility</h3>

<p>It‚Äôs just a simple matter of fact that at some point down the road someone is going to ask you ‚ÄúHey, remember that project from way back when. How did you get those results?‚Äù The nerves will surge in your stomach as you realize you don‚Äôt really remember. Luckily you wrote more of that process into code. If you wrote it out well most of the information about the process should be</p>

<p>Take a look at these two examples and see if you can follow the process</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Import correct modules
</span><span class="kn">import</span> <span class="nn">arcpy</span><span class="p">,</span> <span class="n">os</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>

<span class="c1">## set working directory variable
</span><span class="n">folder_path</span> <span class="o">=</span> <span class="s">r'C:\Users\spater\Desktop\InSitu_Sites\Round2\Projected'</span>

<span class="c1">## set working directory
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span><span class="o">=</span> <span class="n">folder_path</span>

<span class="c1">## set outpath directory -- where buffered files will be saved
</span><span class="n">outpath</span> <span class="o">=</span> <span class="s">r'C:\Users\spater\Desktop\InSitu_Sites\Round2\Buffered_200'</span>

<span class="c1">## creates a list of shapefiles within the workspace
</span><span class="n">fcList</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">ListFeatureClasses</span><span class="p">()</span>

<span class="c1">## for every shapefile in the list create a 200 meter buffer around it and export
## it as a new shapefile to the outpath location
</span><span class="k">for</span> <span class="n">fc</span> <span class="ow">in</span> <span class="n">fcList</span><span class="p">:</span>
    <span class="n">outname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="n">fc</span> <span class="o">+</span> <span class="s">"_buffer.shp"</span><span class="p">)</span>
    <span class="n">arcpy</span><span class="o">.</span><span class="n">Buffer_analysis</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="n">outname</span><span class="p">,</span> <span class="s">"200 Meters"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>
<span class="kn">from</span> <span class="nn">arcpy.sa</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s">r"C:\GIS Data\Cameron_Run\Topo_NED\Projected"</span>

<span class="c1"># Set local variables
</span><span class="n">surfaceRaster</span> <span class="o">=</span> <span class="s">"raw_10m_dem"</span>

<span class="c1"># Check out the ArcGIS Spatial Analyst extension license
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">CheckOutExtension</span><span class="p">(</span><span class="s">"Spatial"</span><span class="p">)</span>

<span class="c1"># Execute FlowDirection
</span><span class="n">fillRaster</span> <span class="o">=</span> <span class="n">Fill</span><span class="p">(</span><span class="n">surfaceRaster</span><span class="p">)</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">RasterToGeodatabase_conversion</span><span class="p">(</span><span class="n">fillRaster</span><span class="p">,</span> <span class="s">r"C:\GISData\Cameron_Run\Topo_NED\Projected\fillRasterGDB.gdb"</span><span class="p">)</span>
</code></pre></div></div>

<p>What you scripts will really become are a clean and practical set of instructions on how the work was done. They are a written description of your process. If you want to redo your work or change parameters based on new information it all there for you. Because you have this reproducibility you can more easily start conduction more robust analysis such as sensitivity analysis.</p>

<h2 id="what-is-arcpy-maxbad-at">What is arcpy max(bad) at‚Ä¶</h2>

<p>Generally specking the learning curve is often the most frustrating part. That said there are a few that will often leave you scratching you head. Consider this section a bit of a heads up.</p>

<h3 id="cursors">Cursors</h3>

<p>Because arcpy is written with python for loops are really very easy. However, if you want to loop through all attributes within a feature class things are just not quite as start forward. Arcpy requires you to use a cursor. These cursors allow you to , update, or insert information to the rows of a feature class. Theses are called</p>

<ul>
  <li>search cursor</li>
  <li>update cursor</li>
  <li>insert cursor</li>
</ul>

<p><a href="http://pro.arcgis.com/en/pro-app/arcpy/get-started/data-access-using-cursors.htm">cursors</a></p>

<p>You use these cursors to create a cursor object. The cursor object then has specific funtions. It‚Äôs getting kinda funky huh? lets look at some examples.</p>

<p><strong>Search Cursor</strong> The search cursor is a read only function. This mean you can use it to extract information from a feature class but you can not change any information within that feature class. This is perfect for extracting specific values. You can incorporate where clauses into these search cusors but were going to pass on that for now</p>

<p><a href="http://pro.arcgis.com/en/pro-app/arcpy/data-access/searchcursor-class.htm">search cursors</a></p>

<p>In this example we want a printed list of information pertaining to a well system.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="c1"># define your dataset
</span><span class="n">fc</span> <span class="o">=</span> <span class="s">'c:/data/base.gdb/well'</span>
<span class="c1"># define what field you want to search through
</span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'WELL_ID'</span><span class="p">,</span> <span class="s">'WELL_TYPE'</span><span class="p">,</span> <span class="s">'SHAPE@XY'</span><span class="p">]</span>

<span class="c1"># For each row print the WELL_ID and WELL_TYPE fields, and
# the feature's x,y coordinates
</span><span class="k">with</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">SearchCursor</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cursor</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">u'{0}, {1}, {2}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</code></pre></div></div>

<p>This will print something line well203494, super3, 100.3949,23.4858 for all rows in the feature class.</p>

<p>Now were seeing a new function here. ‚Äòwith‚Äô Cursors are objects that stay for open until you tell them to close. What this means is that the feature will be held in memorny and un able to be edited by other function while you cursor is open. The exact logo behind this process is beyond me, but if you don‚Äôt follow it, it will come back and bite you.</p>

<p>What the with function does is closes the cursor after it has complete it‚Äôs series of tasks within the object. The example below shows the same thing.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">cursor</span><span class="o">=</span><span class="n">arcpy</span><span class="o">.</span><span class="n">SearchCursor</span><span class="p">(</span><span class="n">IN_Table</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cursor</span><span class="p">:</span>
    <span class="n">printf</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">printf</span><span class="p">)</span>
<span class="k">del</span> <span class="n">row</span><span class="p">,</span> <span class="n">cursor</span>

<span class="c1">#or with with
</span>
<span class="k">with</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">SearchCursor</span><span class="p">(</span><span class="n">IN_Table</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
    <span class="n">printf</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">printf</span><span class="p">)</span>
</code></pre></div></div>

<p>The with example is what we would call more pythonic.</p>

<p><strong>Update cursor</strong> This allows you to rewrite existing layers.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="c1">#define
</span><span class="n">fc</span> <span class="o">=</span> <span class="s">'c:/data/base.gdb/well'</span>
<span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'WELL_YIELD'</span><span class="p">,</span> <span class="s">'WELL_CLASS'</span><span class="p">]</span>

<span class="c1"># Create update cursor for feature class
</span><span class="k">with</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">da</span><span class="o">.</span><span class="n">UpdateCursor</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
    <span class="c1"># For each row, evaluate the WELL_YIELD value (index position
</span>    <span class="c1"># of 0), and update WELL_CLASS (index position of 1)
</span>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cursor</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">):</span>
            <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">):</span>
            <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">):</span>
            <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="c1"># Update the cursor with the updated list
</span>        <span class="n">cursor</span><span class="o">.</span><span class="n">updateRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="conditional-formatting">Conditional Formatting</h3>

<p>In arcmap you use conditional statements all the time. Conditional statements are things such as ‚Äúselect all citys that fall with 50 miles of the this location‚Äù Select by attributes is probably the main function that uses conditional statements. These can be tricky to get correct even with the graphical user interface (interface) that is provided. What you don‚Äôt see is that what you enter is only part of statement. In arcpy you are now responsible for entering all components of the conditional statements and it is challenging to get correct.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">shpExtent</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="s">"""
    inputs a shapefile and returns the target points for the warp function
    shape: needs to be a path to a specific shapefile
    """</span>
    <span class="c1">#create bounding box around shapefile
</span>    <span class="n">shapeBox</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">MinimumBoundingGeometry_management</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="s">"bounding_box"</span><span class="p">,</span>
                                             <span class="s">"RECTANGLE_BY_AREA"</span><span class="p">)</span>
    <span class="c1">#call extent function on shapefile
</span>    <span class="n">w1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">wid1</span><span class="p">,</span> <span class="n">hgt1</span> <span class="o">=</span> <span class="n">extents</span><span class="p">(</span><span class="n">shapeBox</span><span class="p">)</span>
    <span class="c1">#start the formatting for the warp function
</span>    <span class="n">topLeft1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
    <span class="n">topRight1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
    <span class="n">bottomLeft1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
    <span class="n">bottomRight1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>

    <span class="c1">#aside
</span>    <span class="n">targetPoints</span> <span class="o">=</span> <span class="s">" '{}';'{}';'{}';'{}'"</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">topLeft1</span><span class="p">,</span><span class="n">topRight1</span><span class="p">,</span><span class="n">bottomLeft1</span><span class="p">,</span><span class="n">bottomRight1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">targetPoints</span>
</code></pre></div></div>

<p><strong>tips</strong> When you need to write a conditional statement open arc map and write it out using the select by attribute tool or the raster math tool. This will allow you to select the correct text format. From there check out this site <em>link to the conditional format arcpy site</em> Depending on what you are trying to do you will have too follow a specific format. Look this up to save your self the trouble of trying to guess it.</p>

<h3 id="the-learning-curve">The learning Curve</h3>

<p>I mentioned above that the most difficult aspect of arcpy is the learn curve. You go from being able to buffer a .shp in 4 minutes to feeling like your dumber then a box of rocks over the course of two hours. I wish I had a clever work around for this but I really don‚Äôt. Here is an example of a easy process in arcmap that gets a lot harder in arcpy.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Name: ExtractFeaturesByLocationAndAttribute.py
# Description:  Extracts features to a new feature class based on a location and an attribute query.
</span>
<span class="c1"># Import system modules
</span><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="c1"># Set overwrite option
</span><span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">overwriteOutput</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># Put in error trapping in case an error occurs when running tool
</span><span class="k">try</span><span class="p">:</span>

   <span class="c1"># Make a layer from the feature class
</span>   <span class="n">arcpy</span><span class="o">.</span><span class="n">MakeFeatureLayer_management</span><span class="p">(</span><span class="s">"C:/data/mexico.gdb/cities"</span><span class="p">,</span><span class="s">"cities_lyr"</span><span class="p">)</span>

   <span class="c1"># Select all cities that overlap the chihuahua polygon
</span>   <span class="n">arcpy</span><span class="o">.</span><span class="n">SelectLayerByLocation_management</span><span class="p">(</span><span class="s">"cities_lyr"</span><span class="p">,</span> <span class="s">"INTERSECT"</span><span class="p">,</span> <span class="s">"c:/data/mexico.gdb/chihuahua"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="s">"NEW_SELECTION"</span><span class="p">)</span>

   <span class="c1"># Within the selection (done above) further select only those cities that have a population &gt;10,000
</span>   <span class="n">arcpy</span><span class="o">.</span><span class="n">SelectLayerByAttribute_management</span><span class="p">(</span><span class="s">"cities_lyr"</span><span class="p">,</span> <span class="s">"SUBSET_SELECTION"</span><span class="p">,</span> <span class="s">"POPULATION &gt; 10000"</span><span class="p">)</span>

   <span class="c1"># Write the selected features to a new featureclass
</span>   <span class="n">arcpy</span><span class="o">.</span><span class="n">CopyFeatures_management</span><span class="p">(</span><span class="s">"cities_lyr"</span><span class="p">,</span> <span class="s">"c:/data/mexico.gdb/chihuahua_10000plus"</span><span class="p">)</span>

<span class="k">except</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">arcpy</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">())</span>
</code></pre></div></div>

<p>The saving grace of this is that as you get better the time it takes to get the ball rolling decreases and you will eventually find yourself opening arcmap less and less.</p>

<ol>
  <li>Flowcharts activity</li>
</ol>

<p><img src="esriFlowchart.png" alt="flowchart example" /></p>

<p>Don‚Äôt start programming in python. Sounds silly right, but like anything else the more you plan the smoother the process tends to go. I would suggest writing out a flowchart of your process, just with concepts, and explain that process to someone else. If it makes sense to them, go back and fill in that flow chart with more details. Find the specific functions you want to use, look at the requirements of that function, and try to understand if the process is really going to work. If your confident with it then start coding.</p>

<p>If you want to use a for loop try to get the code to work first and then implement the for loop.</p>

<p>If you have a issue, try to write out your problem, in words, and start explaining it to others. This will help you define what the issue actually is. If everyone you spoke to said, yeah that looks right, you probably used a zero in stead of an o or some other silly thing like that.</p>

<p><strong>Print Statements</strong></p>

<p>Use print statements always and often when writing the code. here is an example</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="ow">and</span> <span class="n">np</span>

<span class="k">print</span><span class="p">(</span><span class="s">'all modules have loaded'</span><span class="p">)</span>

<span class="n">raster</span> <span class="o">=</span> <span class="s">r"C:\pahtToRaster"</span>

<span class="k">print</span><span class="p">(</span><span class="s">'raster loaded'</span><span class="p">)</span>

<span class="n">rasterDouble</span> <span class="o">=</span> <span class="n">raster</span> <span class="o">*</span> <span class="mi">2</span>

<span class="k">print</span><span class="p">(</span><span class="s">'raster values have been multipled'</span><span class="p">)</span>
</code></pre></div></div>

<p>it looks crazy I know but if a print statement completes you know what has occurred in your code. IF you don‚Äôt do this you will inevitable set a code to run overnight and return to an undefined 999999 error and will have no idea what when wrong. Troubleshooting scripts that take a long time to run is very very time consuming. So print(‚Äòa lot‚Äô) and you can remove them later.</p>

<ol>
  <li>Last words of wisdom</li>
</ol>

<p><strong>Error Messages are your friends</strong></p>

<p>IF you code throws a error message, and it will, often. Read the whole message and try to make sense of it before you start bashing your computer. Most error messages will have a helpful numerical code associated with them the you can use to search for more details. The really frustrating one is error 999999 or which is essentially an uncaught error. This means that the you made an error that the programmers did not test for, therefore the function can not tell you what actually went wrong. I often find that these tend to be formatting issues. You used a comma instead of a semicolon or you misspelled the feature class you told the function to look for. Silly mistakes that cause real life pain and sorrow. So when an error pops, be happy because it is a clue.</p>

<p><strong>Ask for help quickly</strong></p>

<p>Programming is a community. An online community that is frank and at the end of the day helpful. Get comfortable searching through stackexchange and ESRI forums. You can sometimes find the exact answer to your question and more often then not you can find something that can get you closer. Success in this process has a lot to do with how you ask your question in the first place, that‚Äôs why we write them out.</p>

<p><strong>baby steps</strong></p>

<p>In the beginning you will benefit from running code line by line to ensure that certain aspects of the code works. This is a not a great long term practice but it can help make you feel like you are getting someone.</p>

<p><strong>code for fun</strong></p>

<p>IF you really want to keep this up long term try to apply your programming skills to something that just interest you. And try try try, you will make 40 mistakes before you get it right. The value of those mistakes really comes down to the attitude you bring to the table.</p>

<p><strong>Understand that a functioning code and a pile of text is wholly dependent on you</strong></p>

<p>computers are good at following orders. Scripts are how we can communicate with computers. We write scripts, not the computer. Understand that you are learning and it is not the computers fault. Scapegoats are great but they are not productive in the long term.</p>

<blockquote>
  <p><strong>If you want it, you can have, you just have to learn to reach out there are grab it.</strong></p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
</span><span class="s">"""
Code for setting up the extract multiple values to points in arcpy
The text input is kinda pain in the but so this script uses
glob and some for loops to streamline the process.
Dan Carver 9/28/17
"""</span>

<span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>
<span class="kn">from</span> <span class="nn">arcpy.sa</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">overwriteOutput</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">CheckOutExtension</span><span class="p">(</span><span class="s">"Spatial"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"spatial analysis has been checked out"</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># Set to the folder location that contains all the raster information
</span><span class="n">workspace</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s">r"G:\DEVELOP_Fall2017_CRBII\DEVELOP-CRB\Indicies\LS5\p035r034"</span>

<span class="c1">#select all the files that end in .tif within the defined workspace
</span><span class="n">rasterList</span> <span class="o">=</span> <span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">workspace</span> <span class="o">+</span> <span class="s">"</span><span class="se">\\</span><span class="s">*.tif"</span><span class="p">))</span>

<span class="c1"># define the point feature for extract value process
</span><span class="n">inPointFeatures</span> <span class="o">=</span> <span class="s">r"C:\Users\research\Documents\ArcGIS\Default.gdb\RO_present_06_field_inVbet"</span>

<span class="k">print</span> <span class="s">"this is the feature bring worked with "</span><span class="p">,</span> <span class="n">inPointFeatures</span><span class="p">,</span> <span class="s">'.'</span>
<span class="c1">#create an empty list
</span><span class="n">inRasterList</span> <span class="o">=</span><span class="p">[]</span>
<span class="c1">#itorate through the list of raster names
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rasterList</span><span class="p">:</span>
    <span class="n">txtname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="c1">#select the final segemnt of the path
</span>    <span class="n">file_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,(</span><span class="nb">str</span><span class="p">(</span><span class="n">txtname</span><span class="p">)[</span><span class="mi">12</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">])]</span><span class="c1"># create a list of file directory and file name
</span>    <span class="n">inRasterList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="c1"># append the list to a second list of
</span>
<span class="k">print</span><span class="p">(</span><span class="s">'the raster list has been created'</span><span class="p">)</span>

<span class="c1"># Execute ExtractValuesToPoints
</span><span class="k">print</span> <span class="s">"The extract multiple values to points tool is running, be patient."</span>
<span class="n">ExtractMultiValuesToPoints</span><span class="p">(</span><span class="n">inPointFeatures</span><span class="p">,</span> <span class="n">inRasterList</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">print</span> <span class="s">"This process ran in "</span><span class="p">,(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span> <span class="p">,</span><span class="s">"minutes."</span>
</code></pre></div></div>
:ET